<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Phật dạy Con làm theo</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" >
    <link rel="stylesheet" href="style.css" >

    <link rel="stylesheet" href="/widgets/style.css">
    <link rel="stylesheet" href="/widgets/style5.css">
  </head>
  <body>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    
    ! !-- MA NHUNG THOI TIET -->
    
    <iframe src="index_overlay.html" style="position:fixed;top:0;left:0;width:100vw;height:100vh;z-index:9999;border:none;pointer-events:auto;"></iframe>

    ! DOC NOI DUNG TRANG 

    <div style="display: flex; gap: 10px; flex-wrap: wrap">
      <button onclick="toggleRead()">
        📖 <span id="button-text">ĐỌC NỘI DUNG TRANG</span>
      </button>
      <button id="ttsBtn" onclick="toggleTTS()">🔊 NGHE NỘI DUNG TRANG</button>
      <select id="voiceSelect">
        !<!option value="">Chọn giọng đọc</!option>
      </select>
    </div>

    <div id="output"></div>

    <script>
      let isLoaded = false;
      let isSpeaking = false;
      let utterance;
      let sentenceQueue = [];
      let currentIdx = 0;
      let voices = [];

      function toggleRead() {
        const output = document.getElementById("output");
        const btnText = document.getElementById("button-text");

        if (!isLoaded) {
          const elements = Array.from(
            document.querySelectorAll("p, h1, h2, h3, li, blockquote")
          );
          const text = elements.map((el) => el.innerText).join("\n");
          const sentences = text.split(/(?<=[.?!])\s+/); // chia câu
          output.innerHTML = sentences
            .map((s, i) => `<span id="sent-${i}">${s}</span>`)
            .join(" ");
          sentenceQueue = sentences;
          isLoaded = true;
        }

        if (output.classList.contains("show")) {
          output.classList.remove("show");
          btnText.innerText = "ĐỌC NỘI DUNG TRANG";
          stopTTS();
        } else {
          output.classList.add("show");
          btnText.innerText = "ẨN NỘI DUNG TRANG";
        }
      }

      function toggleTTS() {
        if (!isSpeaking) {
          startReading();
        } else {
          stopTTS();
        }
      }

      function startReading() {
        isSpeaking = true;
        currentIdx = 0;
        document.getElementById("ttsBtn").innerText = "⏹️ DỪNG ĐỌC";
        readNextSentence();
      }

      function readNextSentence() {
        if (currentIdx >= sentenceQueue.length) {
          stopTTS();
          return;
        }

        highlightSentence(currentIdx);

        utterance = new SpeechSynthesisUtterance(sentenceQueue[currentIdx]);
        utterance.lang = "vi-VN";

        // Gán giọng nếu chọn
        const voiceSelect = document.getElementById("voiceSelect");
        const selectedVoiceURI = voiceSelect.value;
        if (selectedVoiceURI) {
          const found = voices.find((v) => v.voiceURI === selectedVoiceURI);
          if (found) utterance.voice = found;
        }

        utterance.onend = () => {
          unhighlightSentence(currentIdx);
          currentIdx++;
          if (isSpeaking) readNextSentence();
        };

        speechSynthesis.speak(utterance);
      }

      function stopTTS() {
        speechSynthesis.cancel();
        isSpeaking = false;
        document.getElementById("ttsBtn").innerText = "🔊 NGHE NỘI DUNG TRANG ";
        unhighlightSentence(currentIdx);
      }

      function highlightSentence(idx) {
        const el = document.getElementById(`sent-${idx}`);
        if (el) el.classList.add("highlight");
      }

      function unhighlightSentence(idx) {
        const el = document.getElementById(`sent-${idx}`);
        if (el) el.classList.remove("highlight");
      }

      function autoSetTheme() {
        const hour = new Date().getHours();
        const body = document.body;
        if (hour >= 18 || hour < 6) {
          body.classList.add("dark");
          body.classList.remove("light");
        } else {
          body.classList.add("light");
          body.classList.remove("dark");
        }
      }

      // Lấy danh sách giọng nói
      function loadVoices() {
        voices = speechSynthesis.getVoices();
        const voiceSelect = document.getElementById("voiceSelect");
        voiceSelect.innerHTML = `<option value="">Chọn giọng đọc</option>`;
        voices
          .filter(
            (v) =>
              v.lang.startsWith("vi") ||
              v.name.toLowerCase().includes("vietnam")
          )
          .forEach((v) => {
            const opt = document.createElement("option");
            opt.value = v.voiceURI;
            opt.textContent = `${v.name} (${v.lang})`;
            voiceSelect.appendChild(opt);
          });
      }

      speechSynthesis.onvoiceschanged = loadVoices;
      autoSetTheme();
    </script>
    
    <!-- KET THUC DOC NOI DUNG TRANG -->
    
    <nav
    <div class="hero">
      <h1><strong>Phật dạy<br> Con làm theo</strong></h1>
    </div>
    <hr>
      <p class="subtitle">
        <h3><strong>Chia sẻ Phật pháp, Ăn chay, Đạo làm người và Lời hay ý đẹp.</strong></h3></p>
    <div 
      class="circle-menu">
        <a href="gioi-thieu.html" title="Giới Thiệu">📜
        </a>
        <a href="video.html" title="Video">🎥
        </a>
        <a href="bai-viet.html" title="Bài Viết">📖
        </a>
        <a href="https://www.youtube.com/@PhatdayConlamtheo" class="center" title="Đăng Ký Kênh YouTube" target="_self">🔔
        </a>
        <a href="tu-sach.html"title="Tủ Sách">📚
        </a>
        <a href="goc-thien.html" title="Góc Thiền">🧘
        </a>
        <a href="tai-mp3.html" title="Tải MP3">🎧
        </a>
    </div>
      
    <section class="video-section">
      <h2>🎥 XEM VIDEO MỚI NHẤT</h2>
    <div class="video-row">
    <div 
      
  <h2>🎼 Giao hưởng YouTube - Âm thanh cho tâm hồn</h2>

  <!-- 🎬 Danh sách video (bạn chỉ cần thêm data-video-id là được!) -->
      
      class="video-box">
      
  <div class="video-block" data-player-id="yt1" data-video-id="NpVbP2aMKH4">
    <iframe id="yt1"></iframe>
    <br>
    <button class="mute-toggle">🔇 Tắt tiếng</button>
  </div>

      class="video-box">
      
  <div class="video-block" data-player-id="yt2" data-video-id="e3uG3NOH0BU">
    <iframe id="yt2"></iframe>
    <br>
    <button class="mute-toggle">🔇 Tắt tiếng</button>
  </div>
      
      class="video-box">
      
  <div class="video-block" data-player-id="yt3" data-video-id="V-TQ5N9ONdU">
    <iframe id="yt3"></iframe>
    <br>
    <button class="mute-toggle">🔇 Tắt tiếng</button>
  </div>
  
      class="video-box">
      
  <div class="video-block" data-player-id="yt4" data-video-id="kz9Dcd5qszY">
    <iframe id="yt4"></iframe>
    <br>
    <button class="mute-toggle">🔇 Tắt tiếng</button>
  </div>

  <!-- ⚙️ Điều chỉnh tốc độ fade -->
  <div class="fade-speed">
    ⏱️ Tốc độ fade âm lượng:
    <input id="fade-speed" type="range" min="100" max="1000" value="200">
    <span id="fade-val">200 ms</span>
  </div>

  <script>
    const players = {};
    let fadeSpeed = 200;

    // Cập nhật slider tốc độ
    const fadeSlider = document.getElementById('fade-speed');
    const fadeVal = document.getElementById('fade-val');
    fadeSlider.addEventListener('input', () => {
      fadeSpeed = parseInt(fadeSlider.value);
      fadeVal.textContent = `${fadeSpeed} ms`;
    });

    // Tải API YouTube
    const tag = document.createElement('script');
    tag.src = "https://www.youtube.com/iframe_api";
    document.body.appendChild(tag);

    // Sau khi API đã sẵn sàng
    function onYouTubeIframeAPIReady() {
      document.querySelectorAll('.video-block').forEach(block => {
        const playerId = block.dataset.playerId;
        const videoId = block.dataset.videoId;
        const iframe = block.querySelector('iframe');
        const button = block.querySelector('.mute-toggle');

        // Gán src cho iframe
        iframe.src = `https://www.youtube.com/embed/${videoId}?enablejsapi=1&autoplay=1&mute=1&loop=1&playlist=${videoId}&controls=0&rel=0&modestbranding=1`;

        // Khởi tạo player
        players[playerId] = new YT.Player(playerId, {
          events: {
            onReady: () => setupPlayerShared(playerId, iframe, button)
          }
        });
      });
    }

    function setupPlayerShared(playerId, iframe, button) {
      const player = players[playerId];
      const key = `muteState_${playerId}`;
      const saved = localStorage.getItem(key);

      if (saved === 'unmuted') {
        player.unMute();
        fadeIn(player);
        iframe.classList.remove('blurred');
        button.textContent = '🔊 Đang phát tiếng';
      } else {
        player.mute();
        iframe.classList.add('blurred');
        button.textContent = '🔇 Tắt tiếng';
      }
      button.addEventListener('click', () => {
        if (player.isMuted()) {
          player.unMute();
          fadeIn(player);
          iframe.classList.remove('blurred');
          button.textContent = '🔊 Đang phát tiếng';
          localStorage.setItem(key, 'unmuted');
        } else {
          fadeOut(player, () => {
            player.mute();
            iframe.classList.add('blurred');
            button.textContent = '🔇 Tắt tiếng';
            localStorage.setItem(key, 'muted');
          });
        }
      });
    }

    function fadeIn(player) {
      let vol = 0;
      player.setVolume(vol);
      const fade = setInterval(() => {
        if (vol < 100) {
          vol += 10;
          player.setVolume(vol);
        } else {
          clearInterval(fade);
        }
      }, fadeSpeed);
    }

    function fadeOut(player, callback) {
      let vol = player.getVolume();
      const fade = setInterval(() => {
        if (vol > 0) {
          vol -= 10;
          player.setVolume(vol);
        } else {
          clearInterval(fade);
          callback();
        }
      }, fadeSpeed);
    }
  </script>
    
  <h2>class="more-videos"></h2>
      <h2>📺 XEM THÊM VIDEO MỚI</h2>
        <h3>
          <ul>
            <li>
              <a href="https://youtu.be/e3uG3NOH0BU?si=5OKEYa4Mk8sh1sU3" target="_self">🌸 KHONG AI GIEO KHO CHO TA NGOAI CHINH MINH 
              </a>
            </li>
          </ul>
        </h3>
        <h3>
          <ul
            <li>
              <a href="https://www.youtube.com/watch?v=LINK2" target="_blank">🌸 Lời mẹ dạy con theo ánh sáng Phật
              </a>
            </li>
          </ul>
        </h3>
        <h3>
          <ul
            <li>
              <a href="https://www.youtube.com/watch?v=LINK3" target="_blank">🌸 Thiền định buông xả – Giọng đọc trầm ấm
              </a>
            </li>
          </ul>
        </h3>
    </div>
    <section>
      <h2>📺 VIDEO GẦN ĐÂY</h2>
    <div>
      <a href="https://www.youtube.com/watch?v=e3uG3NOH0BU" target="_blank">
        <img src="thumbnail1.jpg" alt="Video 1" style="width: 100%; border-radius: 10px;">
        <h3><p><strong>Minh và Vô Minh trong Khổ Đế</strong></p>
        </h3>
      </a>
    </div>
    <div>
      <a href="#" target="_blank">
        <img src="thumbnail2.jpg" alt="Video 2" style="width: 100%; border-radius: 10px;">
        <h3><p><strong>Hành trình về Đất Phật – Sư Minh Tuệ</strong></p>
        </h3>
      </a>
    </div>
    </section>
    <section>
    <div>
      <a class="button" href="video.html">
      <h2>📺 XEM TẤT CẢ CÁC VIDEO TRÊN KÊNH PHẬT DẠY CON LÀM THEO</h2></a>
        </div>
    </section>
    <section>
      <h2>📝 BÀI VIẾT MỚI NHẤT</h2>
    <div class="article">
      <h3>
        <p><strong>📝 Ai giữ được tâm thanh, người ấy đã bước vào cõi Phật</strong></p>
      </h3>
      <h3>
        <p><strong>
        Có những som mai, ta thức dậy trong yên bình, lòng nhẹ như mây, chẳng bị cuốn vào những vòng xoáy hơn thua. Cũng có những buổi chiều, tiếng chuông chùa ngân xa, vọng vào hồn ta một điều giản dị: Tâm an thì cảnh an.</strong></p>
      </h3>
      <h3>
        <p><strong>
        Trong thế gian này, có biết bao nhiêu điều khiến tâm ta rung động, bất an – từ một lời nói, một ánh nhìn, cho đến những tổn thương cũ kỹ nằm im trong ký ức. Nhưng Đức Phật đã dạy: “Tâm là gốc. Nếu tâm an thì mọi pháp đều an.”</strong></p>
      </h3>
      <h3>
        <p><strong>
        Cõi Phật không phải ở đâu xa. Người nào giữa đời sống đầy biến động mà giữ được nội tâm sáng trong, không khởi sân si, không vọng cầu danh lợi – người ấy đã bước vào cõi Phật giữa nhân gian.</strong></p>
      </h3>
      <h3>
        <p><strong>
        Giữ tâm thanh không dễ, nhưng từng hơi thở chánh niệm, từng hành động tỉnh thức, từng lời nói nhu hòa… đều là bước chân trên con đường trở về với chính mình.</strong></p>
      </h3>
      <h3>
        <p><strong>
        Hãy bắt đầu từ hôm nay, từ giây phút này: Hãy giữ tâm thanh.</strong></p>
      </h3>
    </div>
    </section>
    <section>
      <h2>💬 CHIA SẺ TỪ NGƯỜI XEM</h2>
    <div>
        <h3>🧘‍♀️<p><em><strong>“Mỗi lời đọc như chạm vào tâm. Cảm ơn kênh đã thắp sáng cho con một ngọn đèn trong đêm dài.”</strong></em></p>
        </h3>
        <h3>🌿<p><em><strong>“Không giáo điều, không cao siêu, chỉ là những điều giản dị mà sâu sắc. Cảm ơn vì đã lan tỏa đạo Phật đúng cách.”</strong></em></p>
        </h3>
        <h3>🙏<p><em><strong>“Con thấy lòng mình lặng xuống mỗi lần nghe lời dẫn từ kênh. Nguyện học theo từng bước một.”</strong></em></p>
        </h3>
    </div>
    </section>
    <section>
      <h2>📩KẾT NỐI CÙNG CHÚNG TÔI</h2>
        <h3>
          <p><strong>
        Nếu bạn có điều muốn chia sẻ, có những trăn trở tâm linh chưa tìm được lời giải,<br>
        hoặc đơn giản chỉ là muốn gửi lời chào bình an – hãy kết nối cùng chúng tôi qua:</strong></p>
        </h3>
          <h4>📧 Email:<strong>thanhcao197550@gmail.com</strong>
          </h4>
        <h3>🌐 YouTube: <a href="https://www.youtube.com/@phatdayconlamtheo" target="_blank"><strong>Phật dạy Con làm theo</strong></a>
        </h3>
  </section>
  <hr>
  <footer>
    <h3>
      <p><strong>© 2025 Phật dạy Con làm theo – Tâm lành gieo hạt, lời Phật thắp sáng</strong></p>
    </h3>
    </footer>
    
  
  </body>
</html>
